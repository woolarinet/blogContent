---
title: '[Node.js 디자인 패턴] 01.Node.js 플랫폼'
category: 'Node.js'
desc: 'Node.js의 핵심원리 및 철학'
date: '2021-07-29'
thumb: 'node'
---

# Node.js 철학

#### 경량 코어
- 최소한의 기능 세트를 가지고 node.js 코어의 바깥 부분에 사용자 전용 모듈 생태계를 둠.
- 안정적이지만 느리게 진화하는 해결책을 갖는 대신 커뮤니티가 관리자 관점에서의 자유도를 주었다.

#### 경량 모듈
- Node.js는 프로그램 코드를 구성하는 기본적인 수단으로 모듈 개념을 사용. 가장 널리 통용되는 원칙 중 하나는 코드의 양 뿐 아니라 범위의 측면에서도 **작은 모듈**을 디자인 하는 것.
  - 이해하기 쉬우며 사용하기 쉽다.
  - 테스트 및 유지보수가 쉽다.
  - 사이즈가 작아 브라우저에서 사용하기에 완벽하다.

#### 작은 외부 인터페이스
- Node.js의 모듈들이 갖는 장점은 작은 사이즈와 작은 범위, 그리고 최소한의 기능 노출이다.
- 확장보다는 사용되기 위해 만들어졌기 때문에, 구현을 단순화하고, 유지관리를 용이하게 해주며 가용성을 높인다.

#### 간결함과 실용주의

# Node.js 작동원리

#### 이벤트 디멀티플렉싱
- 논 블로킹 리소스를 효율적인 방법으로 처리하기 위한 메커니즘 중 하나를 **동기 이벤트 디멀티플렉서**(=이벤트 통지 인터페이스)라고 한다.
  - 여러 리소스를 관찰하고 이 리소스들 중 읽기 혹은 쓰기 연산의 실행이 완료되었을 때 새로운 이벤트를 반환한다. (*새로운 이벤트가 있을 때까지 블로킹* ) = **이벤트 루프**

#### 리액터(Reactor) 패턴
- 각 I/O 작업에 연관된 핸들러(콜백 함수)를 갖는다.
- 리액터 패턴을 사용하는 애플리케이션의 작업 순서는 다음과 같다.
  - 1. 애플리케이션이 이벤트 디멀티플렉서에 요청을 전달. (새 I/O 작업 생성) 동시에 콜백 함수를 명시. (이벤트 디멀티플렉서에 새 요청을 전다랗는 것은 논 블로킹 호출이며, 제어권은 애플리케이션으로 즉시 반환)
  - 2. 일련의 I/O 작업들이 완료되면 대응되는 이벤트 작업들을 이벤트 큐에 집어 넣는다.
  - 3. 이 시점에서 **이벤트 루프**가 이벤트 큐의 항목들을 순환.
  - 4. 각 이벤트와 관련된 콜백 함수 호출.
  - 5. 콜백 함수의 실행이 완료되면 제어권을 이벤트 루프에 되돌려 준다. (콜백 함수 실행 중 다른 비동기 작업을 요청할 수 있다. = 이벤트 디멀티플렉서에 새로운 항목 추가)
  - 6. 이벤트 큐의 모든 항목이 처리되고 나면 이벤트 루프는 이벤트 디멀티플렉서에서 블로킹되며 처리 가능한 새 이벤트가 있을 경우 이 과정이 다시 트리거 된다.
- ***Reactor 패턴***은 일련의 관찰 대상 리소스에서 새 이벤트를 사용할 수 있을 때까지 블로킹하여 I/O를 처리하고, 각 이벤트를 관련된 콜백 함수에 전달함으로써 반응한다.

#### Libuv
- Node.js의 제일 중요한 구성요소중 하나이다.
- 주요 운영체제에서 Node.js를 호환되게 해주며 서로 다른 리소스 유형의 논 블로킹 동작을 표준화 한다.
- 기본 시스템 호출을 추상화하는 것 외에도 리액터 패턴을 구현하기 위한 API를 제공한다.
- libuv에 대해 더 많은 정보가 있는 무료 온라인 책 -> **[링크](https://nikhilm.github.io/uvbook/)**

#### Node.js를 위한 구성
- 리액터 패턴, libuv외에 3가지의 구성이 더 필요하다.
  - libuv와 다른 저수준 기능들을 랩핑 및 표출시키기 위한 바인딩 세트
  - V8엔진(*Node.js가 매우 빠르고 효율적인 이유 중 하나* )
  - 고수준 Node.js API를 구현하는 코어 Javascript 라이브러리
- 최종적으로 Node.js의 아키텍처는 그림과 같다.
  ![node-structure.png](https://raw.githubusercontent.com/woolarinet/blog_content/main/images/Node.js/platform/1.png)
#### Node.js에서의 Javascript
- Node.js는 DOM을 갖고있지 않으며 window, document도 없다. 반면, 브라우저에서는 불가능하지만 Node.js는 운영체제에서 기본적으로 제공하는 서비스들에 접근이 가능하다.
