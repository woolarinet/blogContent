---
title: '테스트 코드: 코드 커버리지, 테스트 커버리지'
category: 'Node.js'
desc: '테스트 코드의 중요성과 의미'
date: '2021-08-05'
thumb: 'node'
---

# 테스트 커버리지? 코드 커버리지?
- 코드 커버리지를 검색하면 테스트 커버리지가 나오고, 테스트 커버리지를 검색하면 코드커버리지가 나온다.
- 누구는 테스트 코드 커버리지의 약자가 코드 커버리지라 하고, 누구는 제목은 코드커버리지란? 테스트 커버리지란 ~한 것이다 라며 적어놓았다. (솔직히 짜증났다.)
- 결국 둘다 같은 의미인가? 싶었지만 나의 멘토가 다름을 지적하였고, 더 검색을 해보고 마침내 둘은 다르다는 것을 이해할 수 있었다.

### 테스트 커버리지
- 전체 테스트 케이스 중 실행된 테스트 케이스의 비율(테스트 범위)을 뜻한다.
- 100개의 테스트 케이스 중 70개의 테스트 케이스만 실행되었을 때, 테스트 커버리지는 70%가 된다.
### 코드 커버리지
- 코드를 테스트하는 동안 애플리케이션의 소스코드가 실행되는 정도를 나타내는 척도이다.
- 100 줄의 코드 중 70 줄의 코드만 테스트에 의해 실행되었을 때, 코드 커버리지는 70%가 된다.
- 측정 기준에는 
### *!!둘은 엄연히 다른 개념이다.!!*

  &nbsp;  
## 커버리지가 높을수록 좋을까?
- 답은 No 다.
- 테스트의 가치는 ***테스트가 확인하지 못한 코드가 어떤 것***인가와 ***테스트가 프로그래밍 실수를 얼마나 정확하게 잡아내는가***에 좌우된다.
- 100%를 달성했다고 해서 결함이 없다고 보장해주는 건 아니다. 애플리케이션 동작과 상관없이, 그저 모든 코드 or 테스트를 한번씩은 실행해보았다는 것만을 보장할 뿐.

## 테스트별 커버리지
- 사실 아직도 완벽한 이해는 하지 못하고 있다. 따라서 커버리지의 구조에 대해서는 내가 직접 테스트를 실무에 적용해보지 않는 이상 단언하기 힘들 것 같다.
- 커버리지를 측정하는 기준은 크게 5가지로 이루어져 있다(고 한다).

### 구문 커버리지
- 실행된 구문의 비율
### 결정 커버리지 (= 브랜치 커버리지)
- 전체 조건식이 최소 참 한번, 거짓 한번을 가짐의 유무
### 조건 커버리지
- 전체 조건식의 각 개별 조건이 참, 거짓 한번씩 모두 갖도록 조합
### 조건/결정 커버리지
- 전체 조건식과 각 개별 조건식을 참, 거짓 모두 한번씩 갖도록 조합
### 변경 조건/결정 커버리지
- 각 개별 조건식이 전체 조건식의 결과에 독립적으로 영향
### 다중 조건 커버리지
- 모든 개별 조건식의 가능한 모든 논리적 조합 고려 (모든 경우의 수)

  &nbsp;

## 테스트로 얻을 수 있는 두가지
- 이미 높은 커버리지를 달성하여 테스트를 더 만들어도 얻을 것이 미미한 경우
- 테스트를 설계수단으로 이용하는 경우

### ***전자에 더하여, 테스트가 단순한 검증 수단 이상(설계수단)임을 깨닫는 순간 테스트의 가치는 수직상승 하게된다.***

#### **보통의 개발 방식은 소프트웨어 개발을 느리게하는 잠재적 위험이 있다.**
  - 소비자의 요구사항이 처음부터 명확하지 않을 수 있다.
  - 처음부터 완벽한 설계는 어렵다.
  - 소스코드의 품질이 저하될 수 있다.
  - 자체 테스트 비용이 증가할 수 있다.

#### **이러한 코드들은 재사용이 어렵고 관리가 어려워져 유지보수를 어렵게 만든다.**

  &nbsp;
> 테스트는 실사용에 적합한 설계를 끌어내준다. 즉, 테스트를 설계도구로 인식하는 순간 품질 고지를 뛰어넘어 설계고지에 도달하는 길이 열리게 된다. - Effective Unit Testing


# TDD & BDD
- 먼저 개발하고 테스트하는 기존 방식이 아닌, 테스트 코드를 작성하고 검증된 코드를 실제 코드로 반영하는 방식이다.
- **TDD** 는 low-level에서 코드 구조 관점에서 접근하며, 테스트 코드를 작성한 뒤에 실제 코드를 작성한다.
  - 설계단계에서 프로그래밍 목적을 반드시 미리 정의해야하고, 무엇을 테스트해야할지 (테스트 케이스) 미리 정의 해야한다.
  - 테스트 코드를 작성하는 도중에 발생하는 예외사항들은 테스트케이스에 추가하고 설계를 개선한다.
  - **이후 테스트가 통과된 코드만을 코드 개발단계에서 실제 코드로 작성한다.**

- **BDD** 는 행위 주도 개발로써 high-level에서 시나리오 관점으로 접근한다.

- **TDD** 와 **BDD** 는 개발자에게 요구사항을 구현하기 위한 다양한 시각을 제공한다. 구현체를 어떤 방식으로 접근하는 가에 대한 방법만을 제외하면 구현 방식은 매우 흡사하다.
- 개발자의 입장에서 **TDD** 와 **BDD** 의 모호성으로 혼돈을 일으킬 수 있지만, 이 둘은 목적이 될 수 없는 존재이고, 본인의 목적을 이루기 위해 상대적으로 편한 방법 혹은 혼용하는 것이 바람직하다.
- **TDD** 와 **BDD** 는 코드 작성 시에 일어날 수 있는 예외사항 추정과 다른 모듈과의 연계성 고려, 문제해결을 위한 패턴화 능력 등의 성숙도가 높아지게 도와준다.
  - 리팩토링과 주요 요소와 매우 밀접한 연관을 가진다.
  - 고객의 요구사항을 다양한 시선으로 분석하고 구현할 수 있다.
  - 학습과 더불어 프로젝트에 녹아 들어가야 진정한 효과를 발휘한다.
- **TDD** 와 **BDD** 는 지금은 먹기 싫은 쓴 약일 수 있지만 먹고나면 결국 개발 건강을 튼튼히 하는 보약과 같은 존재라고 이야기한다.
### ***리팩토링 단계는 좋은 구조를 안내하거나 가질 수 있도록 하지 않는다. 우리가 스스로 좋은 구조를 찾아 적용할 기회를 제공할 뿐이기에 좋은 구조를 갖는 것은 순전히 우리 몫이 된다.***

## References
- [이규원CTO님의_블로그]
- <https://wooaoe.tistory.com/33>
- [K_data]
- [ko.myservername.com]

[이규원CTO님의_블로그]: https://gyuwon.github.io/blog/2019/03/03/tdd-is-not-a-design-methodology.html?fbclid=IwAR0mQn64MyvSHErsztAvIi1EKEXi9bZYn-OsCPsSC5U7J0GiUQBXC2tqi9o


[K_data]: https://kdata.or.kr/info/info_04_view.html?field=&keyword=&type=techreport&page=48&dbnum=172089&mode=detail&type=techreport

[ko.myservername.com]: https://ko.myservername.com/code-coverage-tutorial#Code_Coverage_Vs_Test_Coverage